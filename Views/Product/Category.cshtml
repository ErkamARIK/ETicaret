@model List<ETicaret.Models.Product>
@{
    ViewData["Title"] = ViewBag.CategoryName + " Ürünleri";
}

<style>
    .product-img {
        width: 100%;
        height: 200px;
        object-fit: contain;
        background-color: #f8f9fa;
        border-bottom: 1px solid #ddd;
        padding: 10px;
    }
</style>

<div class="container mt-4">
    <h2 class="mb-4">@ViewBag.CategoryName Ürünleri</h2>
    <form method="get" class="mb-4">
        <input type="hidden" name="id" value="@ViewContext.RouteData.Values["id"]" />
        <div class="row g-2 align-items-center">
            <div class="col-auto">
                <label for="sortOrder" class="col-form-label">Sırala:</label>
            </div>
            <div class="col-auto">
                <select name="sortOrder" id="sortOrder" class="form-select" onchange="this.form.submit()">
                    @{
                        string sort = ViewBag.CurrentSort as string ?? "";
                    }

                    <option value="" selected="@(sort == "" ? "selected" : null)">Varsayılan</option>
                    <option value="price_asc" selected="@(sort == "price_asc" ? "selected" : null)">Fiyat: Artan</option>
                    <option value="price_desc" selected="@(sort == "price_desc" ? "selected" : null)">Fiyat: Azalan</option>
                    <option value="name_asc" selected="@(sort == "name_asc" ? "selected" : null)">İsim: A-Z</option>
                    <option value="name_desc" selected="@(sort == "name_desc" ? "selected" : null)">İsim: Z-A</option>
                </select>

            </div>
        </div>
    </form>


    @if (!Model.Any())
    {
        <p>Bu kategoriye ait ürün bulunamadı.</p>
    }
    else
    {
        <div class="row row-cols-1 row-cols-md-3 g-4">
            @foreach (var product in Model)
            {
                <div class="col">
                    <a href="/Product/Details/@product.Id" style="text-decoration: none; color: inherit;">
                        <div class="card h-100 shadow-sm">
                            <img src="@product.ImageUrl" class="product-img" alt="@product.Name" />
                            <div class="card-body">
                                <h5 class="card-title">@product.Name</h5>
                                <p class="card-text text-truncate">@product.Description</p>
                                <p class="card-text text-primary fw-bold">@product.Price ₺</p>
                                <form asp-controller="Cart" asp-action="AddToCart" method="post">
                                    <input type="hidden" name="id" value="@product.Id" />
                                    <button type="submit" class="btn btn-primary mt-2">Sepete Ekle</button>
                                </form>
                            </div>
                        </div>
                    </a>
                </div>
            }
        </div>
    }
</div>
